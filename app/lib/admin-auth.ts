import { cookies } from 'next/headers'; import crypto from 'crypto'; const COOKIE='wbn_admin'; const algo='sha256'; export function hashToken(t:string){return crypto.createHash(algo).update(t).digest('hex');} export function isAdminAuthed(){const c=cookies().get(COOKIE)?.value; if(!c) return false; const expected=hashToken(process.env.COMMENTS_ADMIN_TOKEN||''); return c===expected && expected.length>0;} export function adminCookieValue(){return hashToken(process.env.COMMENTS_ADMIN_TOKEN||'');}
