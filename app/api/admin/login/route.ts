import { NextResponse } from 'next/server'; import { adminCookieValue } from '@/app/lib/admin-auth'; export async function POST(req:Request){const {password}=await req.json(); if(!password||password!==process.env.COMMENTS_ADMIN_TOKEN) return NextResponse.json({error:'Invalid password'},{status:401}); const res=NextResponse.json({ok:true}); res.cookies.set({name:'wbn_admin',value:adminCookieValue(),httpOnly:true,secure:true,sameSite:'strict',path:'/',maxAge:60*60*8}); return res;}
